SQL> 
SQL> REM Mastering Oracle SQL [ Mishra,2002,163]
SQL> 
SQL> set linesize 150
SQL> set pagesize 99
SQL> set colsep '||'
SQL> set colsep '|=|'
SQL> set underline =
SQL> set null s/Dato
SQL> 
SQL> rem connect alanmaster/alanmaster
SQL> rem 4,8,13
SQL> 
SQL> rem 57 ignora null no toma en cuenta las filas
SQL> SELECT COUNT(*), SUM(SALE_PRICE), AVG(SALE_PRICE)
  2  FROM CUST_ORDER;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> rem58 toma null como 0
SQL> SELECT AVG(NVL(SALE_PRICE,0)) FROM CUST_ORDER;
SELECT AVG(NVL(SALE_PRICE,0)) FROM CUST_ORDER
                                   *
ERROR en línea 1:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> rem 58
SQL> SELECT COUNT(CUST_NBR), COUNT(DISTINCT CUST_NBR), COUNT(ALL CUST_NBR)
  2  FROM CUST_ORDER;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> rem if we want to find the total number of orders for each customer,execute the following query:
SQL> rem 59
SQL> SELECT CUST_NBR, COUNT(ORDER_NBR)
  2  FROM CUST_ORDER
  3  GROUP BY CUST_NBR;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> rem 61 we might want to display a line number along with the summary information for each customer.
SQL> SELECT ROWNUM, CUST_NBR, COUNT(ORDER_NBR)
  2  FROM CUST_ORDER
  3  GROUP BY ROWNUM, CUST_NBR;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> rem When we GROUP BY a column that contains NULL values for some rows,all the
SQL> rem rows with NULL values are placed into a single group and presented as one summary row in the output.
SQL> rem 63
SQL> SELECT SALE_PRICE, COUNT(ORDER_NBR)
  2  FROM CUST_ORDER
  3  GROUP BY SALE_PRICE;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> rem 64
SQL> SELECT CUST_NBR, COUNT(ORDER_NBR)
  2  FROM CUST_ORDER
  3  WHERE SALE_PRICE > 25
  4  GROUP BY CUST_NBR;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> SELECT CUST_NBR, COUNT(ORDER_NBR)
  2  FROM CUST_ORDER
  3  GROUP BY CUST_NBR;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> SELECT CUST_NBR, SALE_PRICE
  2  FROM CUST_ORDER;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> SELECT CUST_NBR, SALE_PRICE
  2  FROM CUST_ORDER
  3  ORDER BY 1;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> 
SQL> SELECT CUST_NBR, SALE_PRICE
  2  FROM CUST_ORDER
  3  WHERE SALE_PRICE >25
  4  ORDER BY 1;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> SELECT CUST_NBR, COUNT(ORDER_NBR)
  2  FROM CUST_ORDER
  3  GROUP BY CUST_NBR;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> rem where rows, having groups
SQL> SELECT CUST_NBR, COUNT(ORDER_NBR)
  2  FROM CUST_ORDER
  3  GROUP BY CUST_NBR
  4  HAVING CUST_NBR < 260;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> rem 65 no se puede determinar antes de lso grupos
SQL> SELECT CUST_NBR, COUNT(ORDER_NBR)
  2  FROM CUST_ORDER
  3  GROUP BY CUST_NBR
  4  HAVING COUNT(ORDER_NBR) > 2;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> 
SQL> rem 66 group by and having  doesn't matter order in select
SQL> SELECT CUST_NBR, COUNT(ORDER_NBR)
  2  FROM CUST_ORDER
  3  GROUP BY CUST_NBR
  4  HAVING COUNT(ORDER_NBR) > 1;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> SELECT CUST_NBR, COUNT(ORDER_NBR)
  2  FROM CUST_ORDER
  3  HAVING COUNT(ORDER_NBR) > 1
  4  GROUP BY CUST_NBR;
FROM CUST_ORDER
     *
ERROR en línea 2:
ORA-00942: la tabla o vista no existe 


SQL> 
SQL> 
SQL> 
SQL> rem cap 5
SQL> 
SQL> spool off
